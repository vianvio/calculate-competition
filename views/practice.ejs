<!DOCTYPE html>
<html lang="zh-CN" style="overflow: hidden; height: 100vh; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#667eea">
    <title>日常练习</title>
    <link rel="stylesheet" href="/calculate-competition/css/style.css">
</head>
<body class="practice-page" style="overflow: hidden; height: 100vh; padding: 20px 0 0;">
    <!-- Settings Screen -->
    <div id="settingsScreen" class="screen active">
        <div class="container">
            <h1>⚙️ 练习设置</h1>
            
            <div class="settings-form">
                <div class="setting-group">
                    <label>计算类型</label>
                    <div class="calculation-types">
                        <label class="calc-type-card">
                            <input type="checkbox" name="calculationType" value="addition" checked>
                            <span class="calc-icon">➕</span>
                            <span class="calc-name">加法</span>
                        </label>
                        <label class="calc-type-card">
                            <input type="checkbox" name="calculationType" value="subtraction">
                            <span class="calc-icon">➖</span>
                            <span class="calc-name">减法</span>
                        </label>
                        <label class="calc-type-card">
                            <input type="checkbox" name="calculationType" value="multiplication">
                            <span class="calc-icon">✖️</span>
                            <span class="calc-name">乘法</span>
                        </label>
                        <label class="calc-type-card">
                            <input type="checkbox" name="calculationType" value="division">
                            <span class="calc-icon">➗</span>
                            <span class="calc-name">除法</span>
                        </label>
                    </div>
                </div>

                <div class="setting-group">
                    <label>习题数量</label>
                    <div class="number-control">
                        <button type="button" class="btn-control" onclick="adjustQuestionCount(-1)">-1</button>
                        <input type="number" id="questionCount" value="10" min="5" max="100" class="input-medium">
                        <button type="button" class="btn-control" onclick="adjustQuestionCount(1)">+1</button>
                    </div>
                </div>

                <div class="setting-group">
                    <label>运算位数</label>
                    <select id="digits" class="input-medium">
                        <option value="1">1位数</option>
                        <option value="2" selected>2位数</option>
                        <option value="3">3位数</option>
                    </select>
                </div>

                <div class="setting-group">
                    <label class="checkbox-card">
                        <input type="checkbox" id="hasRemainder">
                        <span class="checkbox-label">除法有余数</span>
                    </label>
                </div>

                <div class="setting-group">
                    <label class="checkbox-card">
                        <input type="checkbox" id="hasTimeLimit">
                        <span class="checkbox-label">限制时长</span>
                    </label>
                </div>

                <div class="setting-group" id="timeLimitGroup" style="display: none;">
                    <label>总时长（分钟）</label>
                    <div class="number-control">
                        <button type="button" class="btn-control" onclick="adjustTimeLimit(-1)">-1</button>
                        <input type="number" id="timeLimit" value="5" min="1" max="60" class="input-medium">
                        <button type="button" class="btn-control" onclick="adjustTimeLimit(1)">+1</button>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <a href="/calculate-competition" class="btn btn-secondary btn-large">返回</a>
                <button class="btn btn-primary btn-large" onclick="startPractice()">开始练习</button>
            </div>
        </div>
    </div>

    <!-- Practice Screen -->
    <div id="practiceScreen" class="screen">
        <div class="practice-header">
            <div class="progress-info">
                <span id="currentQuestion">1</span> / <span id="totalQuestions">10</span>
            </div>
            <div class="timer" id="timer">00:00</div>
            <div class="stats">
                <span class="correct" id="correctCount">✓ 0</span>
                <span class="wrong" id="wrongCount">✗ 0</span>
            </div>
        </div>

        <div class="question-container">
            <div class="question-display" id="questionDisplay">
                <span class="question-text">2 + 3 = </span>
                <!-- Normal answer input -->
                <input type="tel" id="answerInput" class="answer-input-inline" placeholder="?" autofocus style="display: inline-block;">
                
                <!-- Division with remainder inputs -->
                <span id="divisionAnswerContainer" class="division-inputs-inline" style="display: none;">
                    <input type="tel" id="quotientInput" class="answer-input-inline-small" placeholder="商">
                    <span style="color: var(--primary-color)"> ... </span>
                    <input type="tel" id="remainderInput" class="answer-input-inline-small" placeholder="余数">
                </span>
            </div>
        </div>

        <div class="number-pad">
            <button class="num-btn" onclick="inputNumber('1')">1</button>
            <button class="num-btn" onclick="inputNumber('2')">2</button>
            <button class="num-btn" onclick="inputNumber('3')">3</button>
            <button class="num-btn" onclick="inputNumber('4')">4</button>
            <button class="num-btn" onclick="inputNumber('5')">5</button>
            <button class="num-btn" onclick="inputNumber('6')">6</button>
            <button class="num-btn" onclick="inputNumber('7')">7</button>
            <button class="num-btn" onclick="inputNumber('8')">8</button>
            <button class="num-btn" onclick="inputNumber('9')">9</button>
            <button class="num-btn" id="directionToggle" onclick="toggleInputDirection()">→</button>
            <button class="num-btn" onclick="inputNumber('0')">0</button>
            <button class="num-btn" onclick="clearInput()">清除</button>
            <button class="num-btn btn-submit" onclick="submitAnswer()">确定</button>
        </div>
    </div>

    <!-- Result Screen -->
    <div id="resultScreen" class="screen">
        <div class="container result-container">
            <h1>🎉 练习完成！</h1>
            
            <div class="result-stats">
                <div class="stat-item">
                    <div class="stat-label">总题数</div>
                    <div class="stat-value" id="resultTotal">10</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">正确</div>
                    <div class="stat-value correct" id="resultCorrect">8</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">错误</div>
                    <div class="stat-value wrong" id="resultWrong">2</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">正确率</div>
                    <div class="stat-value" id="resultAccuracy">80%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">用时</div>
                    <div class="stat-value" id="resultTime">02:35</div>
                </div>
            </div>

            <div id="perfectResult" class="perfect-badge" style="display: none;">
                ⭐️ 全对！太棒了！
            </div>

            <div class="button-group">
                <a href="/calculate-competition/practice/<%= userId %>" class="btn btn-secondary">再来一次</a>
                <a href="/calculate-competition/calendar/<%= userId %>" class="btn btn-primary">查看日历</a>
            </div>
        </div>
    </div>

    <script>
        const userId = <%= userId %>;
    </script>
    <script src="/calculate-competition/js/main.js"></script>
    <script src="/calculate-competition/js/practice.js"></script>
</body>
</html>
